name: Static Checks

on:
  workflow_dispatch:
  workflow_call:

env:
  LICENSES_WHITELIST: Apache-2.0\;ISC\;BSD-2-Clause\;BSD-3-Clause\;MIT\;W3C\;Zlib\;CC-BY-4.0

jobs:
  run-checks:
    name: Run Checks
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Install Dependencies
        uses: ./.github/actions/install-dependencies

      - name: License Check
        run: |
          pnpm -r exec npx license-checker --onlyAllow ${{ env.LICENSES_WHITELIST }}

      - name: Run Lint
        run: pnpm lint

      - name: Run Typecheck
        run: pnpm typecheck

      - name: Run Test
        run: pnpm test
